<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blaze Double — Calculadora Martingale</title>
  <style>
    body{font-family:Inter,system-ui,Segoe UI,Arial;margin:18px;background:#0b1020;color:#e6eef8}
    .card{background:#0f1724;padding:18px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,.6);max-width:980px;margin:auto}
    input,select{padding:8px;border-radius:8px;border:1px solid #1f2a44;background:#081025;color:#e6eef8}
    label{display:block;margin-top:10px;font-size:14px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    button{margin-top:12px;padding:10px 14px;border-radius:10px;border:0;background:#2563eb;color:white;cursor:pointer}
    pre{white-space:pre-wrap;background:#071028;padding:12px;border-radius:8px;margin-top:12px}
    .small{font-size:13px;color:#9fb0d6}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;border-bottom:1px dashed #12304a;text-align:left}
    .green{color:#7ee787}
    .red{color:#ff8b8b}
  </style>
</head>
<body>
  <div class="card">
    <h2>Blaze Double — Calculadora Martingale</h2>
    <p class="small">Simula apostas no jogo <strong>Double</strong> (15 posições: 7 vermelho, 7 preto, 1 branco). Use com responsabilidade.</p>

    <div class="row">
      <div style="flex:1;min-width:220px">
        <label>Saldo (bankroll)</label>
        <input id="bankroll" type="number" value="100" step="0.01" />

        <label>Aposta inicial (stake)</label>
        <input id="stake" type="number" value="1" step="0.01" />

        <label>Max níveis Martingale (máx. dobradas)</label>
        <input id="maxLevel" type="number" value="8" min="0" />

        <label>Stop por sessão (perda máxima)</label>
        <input id="stopLoss" type="number" value="50" step="0.01" />

      </div>

      <div style="flex:1;min-width:220px">
        <label>Meta de lucro por sessão</label>
        <input id="targetProfit" type="number" value="10" step="0.01" />

        <label>Variant Martingale</label>
        <select id="variant">
          <option value="classic">Clássico (dobrar a cada perda)</option>
          <option value="delayed">Martingale atrasado (dobrar após N perdas)</option>
        </select>

        <label id="delayLabel">N perdas antes de começar a dobrar</label>
        <input id="delay" type="number" value="1" min="1" />

        <label>Simulações Monte Carlo (trials)</label>
        <input id="trials" type="number" value="1000" min="1" />
      </div>
    </div>

    <div style="margin-top:12px">
      <button id="runOnce">Executar 1 sessão (até meta/stop)</button>
      <button id="runMC">Executar Monte Carlo</button>
      <button id="reset">Resetar histórico</button>
    </div>

    <pre id="log">Aguardando ação...</pre>

    <h3>Histórico de sessões</h3>
    <table id="table">
      <thead><tr><th>#</th><th>Resultado</th><th>Lucro/Prejuízo</th><th>Rondas</th><th>Maior Aposta</th></tr></thead>
      <tbody></tbody>
    </table>

    <p class="small">Modelo de probabilidades interno: Vermelho = 7/15, Preto = 7/15, Branco = 1/15. Pagamentos: vermelho/preto = 2× (ganho líquido = stake), branco = 14× (ganho líquido = 14× stake).</p>

  </div>

  <script>
    // Probabilidades do jogo Double (15 slots)
    const PROBS = { red:7/15, black:7/15, white:1/15 };
    const PAY = { red:2, black:2, white:14 };

    function spin(){
      const r = Math.random();
      if(r < PROBS.red) return 'red';
      if(r < PROBS.red + PROBS.black) return 'black';
      return 'white';
    }

    const logEl = document.getElementById('log');
    const tbody = document.querySelector('#table tbody');
    let sessionCount = 0;

    function writeLog(s){ logEl.textContent = s; }

    function runSession(opts){
      let bankroll = opts.bankroll;
      const initStake = opts.stake;
      let stake = initStake;
      let level = 0;
      let rounds = 0;
      let maxStake = stake;

      while(true){
        if(bankroll < stake) {
          return {result:'broke', profit: (bankroll - opts.bankroll), rounds, maxStake };
        }
        bankroll -= stake;
        const outcome = spin();
        rounds++;
        if(outcome === 'white'){
          const win = stake * PAY.white;
          bankroll += win;
          level = 0; stake = initStake;
        } else {
          if(outcome === 'red'){
            const win = stake * PAY.red;
            bankroll += win;
            level = 0; stake = initStake;
          } else {
            level++;
            if(opts.variant === 'classic' || level >= opts.delay){
              stake = stake * 2;
            }
          }
        }
        if(stake > maxStake) maxStake = stake;
        const profit = bankroll - opts.bankroll;
        if(profit >= opts.targetProfit) return {result:'target', profit: profit.toFixed(2), rounds, maxStake};
        if(-profit >= opts.stopLoss) return {result:'stop', profit: profit.toFixed(2), rounds, maxStake};
        if(level > opts.maxLevel) return {result:'maxlevel', profit: (bankroll - opts.bankroll).toFixed(2), rounds, maxStake};
      }
    }

    document.getElementById('runOnce').addEventListener('click', ()=>{
      const opts = readOpts();
      const res = runSession(opts);
      sessionCount++;
      tbody.insertAdjacentHTML('afterbegin', `<tr><td>${sessionCount}</td><td>${res.result}</td><td class="${res.profit>=0? 'green':'red'}">${res.profit}</td><td>${res.rounds}</td><td>${res.maxStake}</td></tr>`);
      writeLog(JSON.stringify(res,null,2));
    });

    document.getElementById('runMC').addEventListener('click', ()=>{
      const opts = readOpts();
      const trials = +document.getElementById('trials').value || 1000;
      let wins = 0, stops=0, broke=0, maxlevels=0, totalProfit=0;
      let worst = Infinity, best=-Infinity;
      writeLog('Rodando Monte Carlo — aguarde...');
      for(let i=0;i<trials;i++){
        const r = runSession(opts);
        const p = parseFloat(r.profit) || r.profit;
        totalProfit += +p;
        if(r.result === 'target') wins++;
        if(r.result === 'stop') stops++;
        if(r.result === 'broke') broke++;
        if(r.result === 'maxlevel') maxlevels++;
        if(p < worst) worst = p;
        if(p > best) best = p;
      }
      const avg = totalProfit / trials;
      const summary = {
        trials, wins, stops, broke, maxlevels, avg: avg.toFixed(4), best, worst
      };
      writeLog('Monte Carlo completo:\n' + JSON.stringify(summary,null,2));
      sessionCount++;
      tbody.insertAdjacentHTML('afterbegin', `<tr><td>${sessionCount}</td><td>MC</td><td class="green">avg ${summary.avg}</td><td>trials ${trials}</td><td>—</td></tr>`);
    });

    document.getElementById('reset').addEventListener('click', ()=>{ tbody.innerHTML=''; sessionCount=0; writeLog('Histórico limpo.'); });

    function readOpts(){
      return {
        bankroll: parseFloat(document.getElementById('bankroll').value),
        stake: parseFloat(document.getElementById('stake').value),
        maxLevel: parseInt(document.getElementById('maxLevel').value,10),
        stopLoss: parseFloat(document.getElementById('stopLoss').value),
        targetProfit: parseFloat(document.getElementById('targetProfit').value),
        variant: document.getElementById('variant').value,
        delay: parseInt(document.getElementById('delay').value,10)
      };
    }

    const variant = document.getElementById('variant');
    variant.addEventListener('change', ()=>{
      const v = variant.value;
      document.getElementById('delay').style.display = v==='delayed'? 'inline-block':'none';
      document.getElementById('delayLabel').style.display = v==='delayed'? 'block':'none';
    });
    variant.dispatchEvent(new Event('change'));
  </script>
</body>
</html>